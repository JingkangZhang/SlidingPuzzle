import base64
myscript ='''IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMjIFByb2plY3Q6IFNsaWRpbmcgUHV6emxlICAgICAjIwojIyBDb3B5cmlnaHQgUmVhZHlQeXRob24gU3AxOSAgIyMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpmcm9tIGNvcHkgaW1wb3J0IGRlZXBjb3B5CmZyb20gcmFuZG9tIGltcG9ydCBjaG9pY2UKZnJvbSB0aW1lIGltcG9ydCBzbGVlcAppbXBvcnQgb3MKCnNhbXBsZV9ib2FyZCA9IFsgI3JlcHJlc2VudGVkIGFzIGEgMkQgbGlzdAogICAgWzEsMiwzXSwKICAgIFs0LDUsNl0sCiAgICBbNyw4LDBdICMgMCBzdGFuZHMgZm9yIHRoZSBlbXB0eSBzbG90Cl0KQUNUSU9OUyA9IFsidXAiLCAiZG93biIsICJsZWZ0IiwgInJpZ2h0Il0gI0FjdGlvbnMgYXJlIHJlcHJlc2VudGVkIGFzIHdheXMgdG8gbW92ZSB0aGUgZW1wdHkgc2xvdCAoMCkgYXJvdW5kLgoKZGVmIGNscygpOgogICAgJycnQ2xlYXJzIHRoZSB0ZXJtaW5hbCBzY3JlZW4uJycnCiAgICBvcy5zeXN0ZW0oJ2NscycgaWYgb3MubmFtZT09J250JyBlbHNlICdjbGVhcicpCgpkZWYgcGxheSgpOgogICAgJycnIFBsYXlzIGEgc2xpZGluZyBwdXp6bGUgZ2FtZSBieQogICAgMS4gU2h1ZmZsaW5nIHRoZSBzYW1wbGVfYm9hcmQgdG8gZ2V0IGluaXRpYWwgYm9hcmQgc3RhdGUKICAgIDIuIFNvbHZlIHRoZSBwdXp6bGUgYW5kIG9idGFpbiBhIGxpc3Qgb2YgYWN0aW9ucwogICAgMy4gVmlzdWFsaXplIHRoZSBzb2x1dGlvbgogICAgJycnCiAgICBib2FyZCA9IHNodWZmbGUoc2FtcGxlX2JvYXJkKQogICAgcHJpbnQoIlRoaXMgaXMgdGhlIHJhbmRvbWx5IHNodWZmbGVkIGluaXRpYWwgc3RhdGU6IikKICAgIHByaW50X2JvYXJkKGJvYXJkKQogICAgcHJpbnQoIlNvbHZpbmcuLi4iKQogICAgYWN0aW9ucyA9IHNvbHZlKGJvYXJkKQogICAgaWYgYWN0aW9ucyA9PSAiTk9fU09MVVRJT04iOiAjIEEgY29ycmVjdCBzaHVmZmxlIGZ1bmN0aW9uIHNob3VsZCBOT1QgcmVzdWx0IGluIE5PX1NPTFVUSU9OLgogICAgICAgIHByaW50KCJUaGVyZSBpcyBubyBzb2x1dGlvbiBmcm9tIGN1cnJlbnQgc3RhdGUuIikKICAgICAgICByZXR1cm4KICAgIHByaW50KCJTb2x2ZWQhIikKICAgIGlucHV0KCJQcmVzcyBFbnRlciB0byBzdGFydCB2aXN1YWxpemF0aW9uOiAiKQogICAgdmlzdWFsaXplKGJvYXJkLCBhY3Rpb25zKQoKZGVmIHZpc3VhbGl6ZShib2FyZCwgYWN0aW9ucyk6CiAgICAnJycgVmlzdWFsaXplIHRoZSB0cmFuc2l0aW9ucyBpbiBCT0FSRCBieSBwcmludGluZyBlYWNoIHN0YXRlcyBhZnRlciB0YWtpbmcgYWN0aW9ucy4KICAgIFRyYW5zaXRpb24gdGltZSBpbnRlcnZhbDogMSBzZWNvbmQuIFRoZSBzY3JlZW4gaXMgY2xlYXJlZCBieSBjYWxsaW5nIGNscygpIGJlZm9yZSBwcmludGluZy4gJycnCiAgICBjb3B5ID0gZGVlcGNvcHkoYm9hcmQpCiAgICBmb3IgYWN0aW9uIGluIGFjdGlvbnM6CiAgICAgICAgY29weSA9IHRha2UoYWN0aW9uLCBjb3B5KQogICAgICAgIGNscygpCiAgICAgICAgcHJpbnRfYm9hcmQoY29weSkKICAgICAgICBzbGVlcCgxKQogICAgcHJpbnQoIlNvbHZlZCEgVG90YWwgc3RlcHM6IiwgbGVuKGFjdGlvbnMpKQogICAgcHJpbnQoIkluaXRpYWwgc3RhdGU6IikKICAgIHByaW50X2JvYXJkKGJvYXJkKQogICAgcHJpbnQoIkFjdGlvbnMgdG9vazoiLCBhY3Rpb25zLCAiKEFjdGlvbnMgYXJlIGRlZmluZWQgYXMgd2F5cyB0aGUgZW1wdHkgc2xvdCBpcyBtb3ZlZCBhcm91bmQuKSIpCgoKCmRlZiBwcmludF9ib2FyZChib2FyZCk6CiAgICAnJydQcmludHMgQk9BUkQgdG8gY29uc29sZSBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDoKICAgIC0tLS0tLS0tLS0tLS0KICAgIHwgNCB8IDMgfCA2IHwKICAgIC0tLS0tLS0tLS0tLS0KICAgIHwgICB8IDUgfCA3IHwKICAgIC0tLS0tLS0tLS0tLS0KICAgIHwgMSB8IDggfCA0IHwKICAgIC0tLS0tLS0tLS0tLS0KICAgICcnJwogICAgcHJpbnQoIi0tLS0tLS0tLS0tLS0iKQogICAgZm9yIHJvdyBpbiByYW5nZShsZW4oYm9hcmQpKToKICAgICAgICBwcmludCgifCAiLCBlbmQ9IiIpCiAgICAgICAgZm9yIGNvbCBpbiByYW5nZShsZW4oYm9hcmRbMF0pKToKICAgICAgICAgICAgY29udGVudCA9IGJvYXJkW3Jvd11bY29sXQogICAgICAgICAgICBwcmludChjb250ZW50IGlmIGNvbnRlbnQgIT0gMCBlbHNlICIgIiwgZW5kPSIgfCAiKQogICAgICAgIHByaW50KCJcbi0tLS0tLS0tLS0tLS0iKQoKZGVmIGZpbmRfemVybyhib2FyZCk6CiAgICAnJydSZXR1cm5zIHRoZSBjb29yZGluYXRlIGFzIChyb3dfbnVtYmVyLCBjb2x1bW5fbnVtYmVyKQogICAgb2YgIjAiICh0aGUgZW1wdHkgc2xvdCkgaW4gQk9BUkQuCgogICAgRS5nLgogICAgVGhlIHplcm8gY29vcmRpbmF0ZSBvZiB0aGUgZm9sbG93aW5nIGJvYXJkIGlzICgxLCAwKQogICAgLS0tLS0tLS0tLS0tLQogICAgfCAyIHwgMyB8IDYgfAogICAgLS0tLS0tLS0tLS0tLQogICAgfCAgIHwgNSB8IDcgfAogICAgLS0tLS0tLS0tLS0tLQogICAgfCAxIHwgOCB8IDQgfAogICAgLS0tLS0tLS0tLS0tLQogICAgJycnCiAgICBmb3Igcm93IGluIHJhbmdlKGxlbihib2FyZCkpOgogICAgICAgIGZvciBjb2wgaW4gcmFuZ2UobGVuKGJvYXJkWzBdKSk6CiAgICAgICAgICAgIGlmIGJvYXJkW3Jvd11bY29sXSA9PSAwOgogICAgICAgICAgICAgICAgcmV0dXJuIHJvdywgY29sCgpkZWYgZ2V0X2xlZ2FsX2FjdGlvbnMoYm9hcmQpOgogICAgJycnUmV0dXJucyBhIGxpc3Qgb2YgbGVnYWwgYWN0aW9ucyBpbiBCT0FSRC4gQWN0aW9ucyBhcmUgcmVwcmVzZW50ZWQKICAgIGFzIHdheXMgdG8gbW92ZSB0aGUgZW1wdHkgc2xvdCAoMCkgYXJvdW5kLiBBbiBhY3Rpb24gc2hvdWxkIGJlIGluCiAgICBbInVwIiwgImRvd24iLCAibGVmdCIsICJyaWdodCJdLgoKICAgIEUuZy4gSW4gdGhlIGZvbGxvd2luZyBib2FyZCwgdGhlIGxlZ2FsIGFjdGlvbnMgYXJlIFsidXAiLCAiZG93biIsICJyaWdodCJdLgogICAgLS0tLS0tLS0tLS0tLQogICAgfCAyIHwgMyB8IDYgfAogICAgLS0tLS0tLS0tLS0tLQogICAgfCAgIHwgNSB8IDcgfAogICAgLS0tLS0tLS0tLS0tLQogICAgfCAxIHwgOCB8IDQgfAogICAgLS0tLS0tLS0tLS0tLScnJwogICAgemVyb19wb3MgPSBmaW5kX3plcm8oYm9hcmQpCiAgICBib2FyZF9yb3dzID0gbGVuKGJvYXJkKQogICAgYm9hcmRfY29scyA9IGxlbihib2FyZFswXSkKICAgIGFjdGlvbnMgPSBBQ1RJT05TWzpdCiAgICBpZiB6ZXJvX3Bvc1swXSA9PSAwOgogICAgICAgIGFjdGlvbnMucmVtb3ZlKCJ1cCIpCiAgICBpZiB6ZXJvX3Bvc1swXSA9PSBib2FyZF9yb3dzIC0gMToKICAgICAgICBhY3Rpb25zLnJlbW92ZSgiZG93biIpCiAgICBpZiB6ZXJvX3Bvc1sxXSA9PSAwOgogICAgICAgIGFjdGlvbnMucmVtb3ZlKCJsZWZ0IikKICAgIGlmIHplcm9fcG9zWzFdID09IGJvYXJkX2NvbHMgLSAxOgogICAgICAgIGFjdGlvbnMucmVtb3ZlKCJyaWdodCIpCiAgICByZXR1cm4gYWN0aW9ucwoKZGVmIHRha2UoYWN0aW9uLCBib2FyZCk6CiAgICAnJydSZXR1cm5zIHRoZSByZXN1bHRpbmcgYm9hcmQgYWZ0ZXIgdGFraW5nIEFDVElPTiBvbiBCT0FSRCwKICAgIGFzc3VtaW5nIEFDVElPTiBpcyBsZWdhbC4gQUNUSU9OIHNob3VsZCBiZSBpbiBbInVwIiwgImRvd24iLCAibGVmdCIsICJyaWdodCJdLgogICAgQWN0aW9ucyBhcmUgcmVwcmVzZW50ZWQgYXMgd2F5cyB0byBtb3ZlIHRoZSBlbXB0eSBzbG90ICgwKSBhcm91bmQuCgogICAgRS5nLgogICAgLS0tLS0tLS0tLS0tLQogICAgfCAyIHwgMyB8IDYgfAogICAgLS0tLS0tLS0tLS0tLQogICAgfCAgIHwgNSB8IDcgfAogICAgLS0tLS0tLS0tLS0tLQogICAgfCAxIHwgOCB8IDQgfAogICAgLS0tLS0tLS0tLS0tLQogICAgVGFraW5nIGFjdGlvbiAidXAiIGluIHRoZSBhYm92ZSBib2FyZCB3aWxsIHJlc3VsdCBpbiB0aGUgZm9sbG93aW5nIGJvYXJkOgogICAgLS0tLS0tLS0tLS0tLQogICAgfCAgIHwgMyB8IDYgfAogICAgLS0tLS0tLS0tLS0tLQogICAgfCAyIHwgNSB8IDcgfAogICAgLS0tLS0tLS0tLS0tLQogICAgfCAxIHwgOCB8IDQgfAogICAgLS0tLS0tLS0tLS0tLQogICAgJycnCiAgICBhc3NlcnQgYWN0aW9uIGluIEFDVElPTlMsICJJbnZhbGlkIGFjdGlvbjogJ3t9JyIuZm9ybWF0KGFjdGlvbikKICAgIHplcm9fcG9zID0gZmluZF96ZXJvKGJvYXJkKQogICAgemVyb19yb3cgPSB6ZXJvX3Bvc1swXQogICAgemVyb19jb2wgPSB6ZXJvX3Bvc1sxXQogICAgbmV3X2JvYXJkID0gZGVlcGNvcHkoYm9hcmQpCiAgICBpZiBhY3Rpb24gPT0gInVwIjoKICAgICAgICBuZXdfYm9hcmRbemVyb19yb3ddW3plcm9fY29sXSwgbmV3X2JvYXJkW3plcm9fcm93IC0gMV1bemVyb19jb2xdID0gbmV3X2JvYXJkW3plcm9fcm93IC0gMV1bemVyb19jb2xdLCBuZXdfYm9hcmRbemVyb19yb3ddW3plcm9fY29sXQogICAgaWYgYWN0aW9uID09ICJkb3duIjoKICAgICAgICBuZXdfYm9hcmRbemVyb19yb3ddW3plcm9fY29sXSwgbmV3X2JvYXJkW3plcm9fcm93ICsgMV1bemVyb19jb2xdID0gbmV3X2JvYXJkW3plcm9fcm93ICsgMV1bemVyb19jb2xdLCBuZXdfYm9hcmRbemVyb19yb3ddW3plcm9fY29sXQogICAgaWYgYWN0aW9uID09ICJsZWZ0IjoKICAgICAgICBuZXdfYm9hcmRbemVyb19yb3ddW3plcm9fY29sXSwgbmV3X2JvYXJkW3plcm9fcm93XVt6ZXJvX2NvbCAtIDFdID0gbmV3X2JvYXJkW3plcm9fcm93XVt6ZXJvX2NvbCAtIDFdLCBuZXdfYm9hcmRbemVyb19yb3ddW3plcm9fY29sXQogICAgaWYgYWN0aW9uID09ICJyaWdodCI6CiAgICAgICAgbmV3X2JvYXJkW3plcm9fcm93XVt6ZXJvX2NvbF0sIG5ld19ib2FyZFt6ZXJvX3Jvd11bemVyb19jb2wgKyAxXSA9IG5ld19ib2FyZFt6ZXJvX3Jvd11bemVyb19jb2wgKyAxXSwgbmV3X2JvYXJkW3plcm9fcm93XVt6ZXJvX2NvbF0KICAgIHJldHVybiBuZXdfYm9hcmQKCmRlZiBzaHVmZmxlKGJvYXJkKToKICAgICcnJ1JldHVybiBhIG5ldyBib2FyZCBvYnRhaW5lZCBieSB0YWtpbmcgNTAgcmFuZG9tCiAgICBhY3Rpb25zIGZyb20gQk9BUkQuICcnJwogICAgbmV3X2JvYXJkID0gZGVlcGNvcHkoYm9hcmQpCiAgICBmb3IgaSBpbiByYW5nZSg1MCk6CiAgICAgICAgYWN0aW9uID0gY2hvaWNlKGdldF9sZWdhbF9hY3Rpb25zKG5ld19ib2FyZCkpCiAgICAgICAgbmV3X2JvYXJkID0gdGFrZShhY3Rpb24sIG5ld19ib2FyZCkKICAgIHJldHVybiBuZXdfYm9hcmQKCmRlZiBpc19nb2FsKGJvYXJkKToKICAgICcnJ1JldHVybnMgVHJ1ZSBpZmYgQk9BUkQgaXMKICAgIC0tLS0tLS0tLS0tLS0KICAgIHwgMSB8IDIgfCAzIHwKICAgIC0tLS0tLS0tLS0tLS0KICAgIHwgNCB8IDUgfCA2IHwKICAgIC0tLS0tLS0tLS0tLS0KICAgIHwgNyB8IDggfCAgIHwKICAgIC0tLS0tLS0tLS0tLS0nJycKICAgIHJldHVybiBib2FyZCA9PSBbWzEsMiwzXSxbNCw1LDZdLFs3LDgsMF1dCgpkZWYgc29sdmUoYm9hcmQpOgogICAgJycnUmV0dXJucyBhIGxpc3Qgb2YgYWN0aW9ucyB3aGljaCwgdGFrZW4gb24gQk9BUkQsIHNvbHZlcyB0aGUgcHV6emxlIGJ5CiAgICB0dXJuaW5nIHRoZSBib2FyZCBpbnRvIHRoZSBmb2xsb3dpbmcgZm9ybToKICAgIC0tLS0tLS0tLS0tLS0KICAgIHwgMSB8IDIgfCAzIHwKICAgIC0tLS0tLS0tLS0tLS0KICAgIHwgNCB8IDUgfCA2IHwKICAgIC0tLS0tLS0tLS0tLS0KICAgIHwgNyB8IDggfCAgIHwKICAgIC0tLS0tLS0tLS0tLS0KICAgICcnJwogICAgdmlzaXRlZCA9IHNldCgpICMgVGhpcyBzdG9yZXMgYm9hcmRzIGNvbnZlcnRlZCB0byBzdHJpbmdzIGZyb20gMkQgbGlzdHMuCiAgICBxID0gW10KICAgIHEuYXBwZW5kKFtbYm9hcmQsIE5vbmVdXSkgIyBUaGUgZWxlbWVudHMgb24gdGhlIGZyaW5nZSBhcmUgKGJvYXJkX3N0YXRlLCBsYXN0X2FjdGlvbikKICAgIHdoaWxlIHE6CiAgICAgICAgcGF0aCA9IHEucG9wKDApCiAgICAgICAgbGFzdF9ib2FyZCA9IHBhdGhbLTFdWzBdCiAgICAgICAgaWYgc3RyKGxhc3RfYm9hcmQpIG5vdCBpbiB2aXNpdGVkOgogICAgICAgICAgICB2aXNpdGVkLmFkZChzdHIobGFzdF9ib2FyZCkpCiAgICAgICAgICAgIGlmIGlzX2dvYWwobGFzdF9ib2FyZCk6CiAgICAgICAgICAgICAgICAjIHJldHVybiBwYXRoCiAgICAgICAgICAgICAgICByZXR1cm4gW3N0YXRlWzFdIGZvciBzdGF0ZSBpbiBwYXRoXVsxOl0gIyBXZSBvbmx5IG5lZWQgdG8gcmV0dXJuIGEgbGlzdCBvZiBhY3Rpb25zCiAgICAgICAgICAgIGZvciBhY3Rpb24gaW4gZ2V0X2xlZ2FsX2FjdGlvbnMobGFzdF9ib2FyZCk6CiAgICAgICAgICAgICAgICBuZXdfc3RhdGUgPSBbdGFrZShhY3Rpb24sIGxhc3RfYm9hcmQpLCBhY3Rpb25dCiAgICAgICAgICAgICAgICBuZXdfcGF0aCA9IHBhdGggKyBbbmV3X3N0YXRlXQogICAgICAgICAgICAgICAgcS5hcHBlbmQobmV3X3BhdGgpCiAgICByZXR1cm4gIk5PX1NPTFVUSU9OIgoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgIHByaW50KCI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IikKICAgIHByaW50KCJXZWxjb21lIHRvIFJlYWR5UHl0aG9uIFByb2plY3Q6IFNpbGRpbmcgUHV6emxlISIpCiAgICBwbGF5KCkK'''
eval(compile(base64.b64decode(myscript),'<string>','exec'))