import base64
myscript ='''IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMjIFByb2plY3Q6IFNsaWRpbmcgUHV6emxlICAgICAjIwojIyBDb3B5cmlnaHQgUmVhZHlQeXRob24gU3AxOSAgIyMKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZnJvbSBjb3B5IGltcG9ydCBkZWVwY29weSAjIFVzZWQgdG8gY29weSBib2FyZHMgcmVwcmVzZW50ZWQgYXMgMkQgbGlzdHMKZnJvbSByYW5kb20gaW1wb3J0IGNob2ljZSAjIFVzZWQgaW4gc2h1ZmZsZSgpIHRvIGNob29zZSByYW5kb21seSBmcm9tIGxlZ2FsIGFjdGlvbnMKZnJvbSB0aW1lIGltcG9ydCBzbGVlcCAjIFVzZWQgaW4gdmlzdWFsaXphdGlvbgppbXBvcnQgb3MgIyB1c2VmdWwgZm9yIGNsZWFyIGNvbnNvbGUgc2NyZWVuIHV0aWxpdHkKCnNhbXBsZV9ib2FyZCA9IFsgI3JlcHJlc2VudGVkIGFzIGEgMkQgbGlzdAogICAgWzEsMiwzXSwKICAgIFs0LDUsNl0sCiAgICBbNyw4LDBdICMgMCBzdGFuZHMgZm9yIHRoZSBlbXB0eSBzbG90Cl0KQUNUSU9OUyA9IFsidXAiLCAiZG93biIsICJsZWZ0IiwgInJpZ2h0Il0gI0FjdGlvbnMgYXJlIHJlcHJlc2VudGVkIGFzIHdheXMgdG8gbW92ZSB0aGUgZW1wdHkgc2xvdCAoMCkgYXJvdW5kLgoKZGVmIHByaW50X2JvYXJkKGJvYXJkKToKICAgICcnJ1ByaW50cyBCT0FSRCB0byBjb25zb2xlIGluIHRoZSBmb2xsb3dpbmcgZm9ybWF0OgogICAgLS0tLS0tLS0tLS0tLQogICAgfCA0IHwgMyB8IDYgfAogICAgLS0tLS0tLS0tLS0tLQogICAgfCAgIHwgNSB8IDcgfAogICAgLS0tLS0tLS0tLS0tLQogICAgfCAxIHwgOCB8IDQgfAogICAgLS0tLS0tLS0tLS0tLQogICAgJycnCiAgICBwcmludCgiLS0tLS0tLS0tLS0tLSIpCiAgICBmb3Igcm93IGluIHJhbmdlKGxlbihib2FyZCkpOgogICAgICAgIHByaW50KCJ8ICIsIGVuZD0iIikKICAgICAgICBmb3IgY29sIGluIHJhbmdlKGxlbihib2FyZFswXSkpOgogICAgICAgICAgICBjb250ZW50ID0gYm9hcmRbcm93XVtjb2xdCiAgICAgICAgICAgIHByaW50KGNvbnRlbnQgaWYgY29udGVudCAhPSAwIGVsc2UgIiAiLCBlbmQ9IiB8ICIpCiAgICAgICAgcHJpbnQoIlxuLS0tLS0tLS0tLS0tLSIpCgpkZWYgcGxheSgpOgogICAgJycnIFBsYXlzIGEgc2xpZGluZyBwdXp6bGUgZ2FtZSBieQogICAgMS4gU2h1ZmZsaW5nIHRoZSBzYW1wbGVfYm9hcmQgdG8gZ2V0IGluaXRpYWwgYm9hcmQgc3RhdGUKICAgIDIuIFNvbHZlIHRoZSBwdXp6bGUgYW5kIG9idGFpbiBhIGxpc3Qgb2YgYWN0aW9ucwogICAgMy4gVmlzdWFsaXplIHRoZSBzb2x1dGlvbgogICAgJycnCiAgICBib2FyZCA9IHNodWZmbGUoc2FtcGxlX2JvYXJkKQogICAgcHJpbnQoIlRoaXMgaXMgdGhlIHJhbmRvbWx5IHNodWZmbGVkIGluaXRpYWwgc3RhdGU6IikKICAgIHByaW50X2JvYXJkKGJvYXJkKQogICAgcHJpbnQoIlNvbHZpbmcuLi4iKQogICAgYWN0aW9ucyA9IHNvbHZlKGJvYXJkKQogICAgaWYgYWN0aW9ucyA9PSAiTk9fU09MVVRJT04iOiAjIEEgY29ycmVjdCBzaHVmZmxlIGZ1bmN0aW9uIHNob3VsZCBOT1QgcmVzdWx0IGluIE5PX1NPTFVUSU9OLgogICAgICAgIHByaW50KCJUaGVyZSBpcyBubyBzb2x1dGlvbiBmcm9tIGN1cnJlbnQgc3RhdGUuIikKICAgICAgICByZXR1cm4KICAgIHByaW50KCJTb2x2ZWQhIikKICAgIGlucHV0KCJQcmVzcyBFbnRlciB0byBzdGFydCB2aXN1YWxpemF0aW9uOiAiKQogICAgdmlzdWFsaXplKGJvYXJkLCBhY3Rpb25zKQoKZGVmIHZpc3VhbGl6ZShib2FyZCwgYWN0aW9ucyk6CiAgICAnJycgVmlzdWFsaXplIHRoZSB0cmFuc2l0aW9ucyBpbiBCT0FSRCBieSBwcmludGluZyBlYWNoIHN0YXRlcyBhZnRlciB0YWtpbmcgYWN0aW9ucy4KICAgIFRyYW5zaXRpb24gdGltZSBpbnRlcnZhbDogMSBzZWNvbmQuIFRoZSBzY3JlZW4gaXMgY2xlYXJlZCBieSBjYWxsaW5nIGNscygpIGJlZm9yZSBwcmludGluZy4gJycnCiAgICBjb3B5ID0gZGVlcGNvcHkoYm9hcmQpCiAgICBmb3IgYWN0aW9uIGluIGFjdGlvbnM6CiAgICAgICAgY29weSA9IHRha2UoYWN0aW9uLCBjb3B5KQogICAgICAgIGNscygpCiAgICAgICAgcHJpbnRfYm9hcmQoY29weSkKICAgICAgICBzbGVlcCgxKQogICAgcHJpbnQoIlNvbHZlZCEgVG90YWwgc3RlcHM6IiwgbGVuKGFjdGlvbnMpKQogICAgcHJpbnQoIkluaXRpYWwgc3RhdGU6IikKICAgIHByaW50X2JvYXJkKGJvYXJkKQogICAgcHJpbnQoIkFjdGlvbnMgdG9vazoiLCBhY3Rpb25zLCAiKEFjdGlvbnMgYXJlIGRlZmluZWQgYXMgd2F5cyB0aGUgZW1wdHkgc2xvdCBpcyBtb3ZlZCBhcm91bmQuKSIpCgpkZWYgZmluZF96ZXJvKGJvYXJkKToKICAgICcnJ1JldHVybnMgdGhlIGNvb3JkaW5hdGUgYXMgKHJvd19udW1iZXIsIGNvbHVtbl9udW1iZXIpCiAgICBvZiAiMCIgKHRoZSBlbXB0eSBzbG90KSBpbiBCT0FSRC4KCiAgICBFLmcuCiAgICBUaGUgemVybyBjb29yZGluYXRlIG9mIHRoZSBmb2xsb3dpbmcgYm9hcmQgaXMgKDEsIDApCiAgICAtLS0tLS0tLS0tLS0tCiAgICB8IDIgfCAzIHwgNiB8CiAgICAtLS0tLS0tLS0tLS0tCiAgICB8ICAgfCA1IHwgNyB8CiAgICAtLS0tLS0tLS0tLS0tCiAgICB8IDEgfCA4IHwgNCB8CiAgICAtLS0tLS0tLS0tLS0tCiAgICAnJycKICAgIGZvciByb3cgaW4gcmFuZ2UobGVuKGJvYXJkKSk6CiAgICAgICAgZm9yIGNvbCBpbiByYW5nZShsZW4oYm9hcmRbMF0pKToKICAgICAgICAgICAgaWYgYm9hcmRbcm93XVtjb2xdID09IDA6CiAgICAgICAgICAgICAgICByZXR1cm4gcm93LCBjb2wKCmRlZiBnZXRfbGVnYWxfYWN0aW9ucyhib2FyZCk6CiAgICAnJydSZXR1cm5zIGEgbGlzdCBvZiBsZWdhbCBhY3Rpb25zIGluIEJPQVJELiBBY3Rpb25zIGFyZSByZXByZXNlbnRlZAogICAgYXMgd2F5cyB0byBtb3ZlIHRoZSBlbXB0eSBzbG90ICgwKSBhcm91bmQuIEFuIGFjdGlvbiBzaG91bGQgYmUgaW4KICAgIFsidXAiLCAiZG93biIsICJsZWZ0IiwgInJpZ2h0Il0uCgogICAgRS5nLiBJbiB0aGUgZm9sbG93aW5nIGJvYXJkLCB0aGUgbGVnYWwgYWN0aW9ucyBhcmUgWyJ1cCIsICJkb3duIiwgInJpZ2h0Il0uCiAgICAtLS0tLS0tLS0tLS0tCiAgICB8IDIgfCAzIHwgNiB8CiAgICAtLS0tLS0tLS0tLS0tCiAgICB8ICAgfCA1IHwgNyB8CiAgICAtLS0tLS0tLS0tLS0tCiAgICB8IDEgfCA4IHwgNCB8CiAgICAtLS0tLS0tLS0tLS0tJycnCiAgICB6ZXJvX3BvcyA9IGZpbmRfemVybyhib2FyZCkKICAgIGJvYXJkX3Jvd3MgPSBsZW4oYm9hcmQpCiAgICBib2FyZF9jb2xzID0gbGVuKGJvYXJkWzBdKQogICAgYWN0aW9ucyA9IEFDVElPTlNbOl0KICAgIGlmIHplcm9fcG9zWzBdID09IDA6CiAgICAgICAgYWN0aW9ucy5yZW1vdmUoInVwIikKICAgIGlmIHplcm9fcG9zWzBdID09IGJvYXJkX3Jvd3MgLSAxOgogICAgICAgIGFjdGlvbnMucmVtb3ZlKCJkb3duIikKICAgIGlmIHplcm9fcG9zWzFdID09IDA6CiAgICAgICAgYWN0aW9ucy5yZW1vdmUoImxlZnQiKQogICAgaWYgemVyb19wb3NbMV0gPT0gYm9hcmRfY29scyAtIDE6CiAgICAgICAgYWN0aW9ucy5yZW1vdmUoInJpZ2h0IikKICAgIHJldHVybiBhY3Rpb25zCgpkZWYgdGFrZShhY3Rpb24sIGJvYXJkKToKICAgICcnJ1JldHVybnMgdGhlIHJlc3VsdGluZyBib2FyZCBhZnRlciB0YWtpbmcgQUNUSU9OIG9uIEJPQVJELAogICAgYXNzdW1pbmcgQUNUSU9OIGlzIGxlZ2FsLiBBQ1RJT04gc2hvdWxkIGJlIGluIFsidXAiLCAiZG93biIsICJsZWZ0IiwgInJpZ2h0Il0uCiAgICBBY3Rpb25zIGFyZSByZXByZXNlbnRlZCBhcyB3YXlzIHRvIG1vdmUgdGhlIGVtcHR5IHNsb3QgKDApIGFyb3VuZC4KCiAgICBFLmcuCiAgICAtLS0tLS0tLS0tLS0tCiAgICB8IDIgfCAzIHwgNiB8CiAgICAtLS0tLS0tLS0tLS0tCiAgICB8ICAgfCA1IHwgNyB8CiAgICAtLS0tLS0tLS0tLS0tCiAgICB8IDEgfCA4IHwgNCB8CiAgICAtLS0tLS0tLS0tLS0tCiAgICBUYWtpbmcgYWN0aW9uICJ1cCIgaW4gdGhlIGFib3ZlIGJvYXJkIHdpbGwgcmVzdWx0IGluIHRoZSBmb2xsb3dpbmcgYm9hcmQ6CiAgICAtLS0tLS0tLS0tLS0tCiAgICB8ICAgfCAzIHwgNiB8CiAgICAtLS0tLS0tLS0tLS0tCiAgICB8IDIgfCA1IHwgNyB8CiAgICAtLS0tLS0tLS0tLS0tCiAgICB8IDEgfCA4IHwgNCB8CiAgICAtLS0tLS0tLS0tLS0tCiAgICAnJycKICAgIGFzc2VydCBhY3Rpb24gaW4gQUNUSU9OUywgIkludmFsaWQgYWN0aW9uOiAne30nIi5mb3JtYXQoYWN0aW9uKQogICAgemVyb19wb3MgPSBmaW5kX3plcm8oYm9hcmQpCiAgICB6ZXJvX3JvdyA9IHplcm9fcG9zWzBdCiAgICB6ZXJvX2NvbCA9IHplcm9fcG9zWzFdCiAgICBuZXdfYm9hcmQgPSBkZWVwY29weShib2FyZCkKICAgIGlmIGFjdGlvbiA9PSAidXAiOgogICAgICAgIG5ld19ib2FyZFt6ZXJvX3Jvd11bemVyb19jb2xdLCBuZXdfYm9hcmRbemVyb19yb3cgLSAxXVt6ZXJvX2NvbF0gPSBuZXdfYm9hcmRbemVyb19yb3cgLSAxXVt6ZXJvX2NvbF0sIG5ld19ib2FyZFt6ZXJvX3Jvd11bemVyb19jb2xdCiAgICBpZiBhY3Rpb24gPT0gImRvd24iOgogICAgICAgIG5ld19ib2FyZFt6ZXJvX3Jvd11bemVyb19jb2xdLCBuZXdfYm9hcmRbemVyb19yb3cgKyAxXVt6ZXJvX2NvbF0gPSBuZXdfYm9hcmRbemVyb19yb3cgKyAxXVt6ZXJvX2NvbF0sIG5ld19ib2FyZFt6ZXJvX3Jvd11bemVyb19jb2xdCiAgICBpZiBhY3Rpb24gPT0gImxlZnQiOgogICAgICAgIG5ld19ib2FyZFt6ZXJvX3Jvd11bemVyb19jb2xdLCBuZXdfYm9hcmRbemVyb19yb3ddW3plcm9fY29sIC0gMV0gPSBuZXdfYm9hcmRbemVyb19yb3ddW3plcm9fY29sIC0gMV0sIG5ld19ib2FyZFt6ZXJvX3Jvd11bemVyb19jb2xdCiAgICBpZiBhY3Rpb24gPT0gInJpZ2h0IjoKICAgICAgICBuZXdfYm9hcmRbemVyb19yb3ddW3plcm9fY29sXSwgbmV3X2JvYXJkW3plcm9fcm93XVt6ZXJvX2NvbCArIDFdID0gbmV3X2JvYXJkW3plcm9fcm93XVt6ZXJvX2NvbCArIDFdLCBuZXdfYm9hcmRbemVyb19yb3ddW3plcm9fY29sXQogICAgcmV0dXJuIG5ld19ib2FyZAoKZGVmIHNodWZmbGUoYm9hcmQpOgogICAgJycnUmV0dXJuIGEgbmV3IGJvYXJkIG9idGFpbmVkIGJ5IHRha2luZyA1MCByYW5kb20KICAgIGFjdGlvbnMgZnJvbSBCT0FSRC4gJycnCiAgICBuZXdfYm9hcmQgPSBkZWVwY29weShib2FyZCkKICAgIGZvciBpIGluIHJhbmdlKDUwKToKICAgICAgICBhY3Rpb24gPSBjaG9pY2UoZ2V0X2xlZ2FsX2FjdGlvbnMobmV3X2JvYXJkKSkKICAgICAgICBuZXdfYm9hcmQgPSB0YWtlKGFjdGlvbiwgbmV3X2JvYXJkKQogICAgcmV0dXJuIG5ld19ib2FyZAoKZGVmIGlzX2dvYWwoYm9hcmQpOgogICAgJycnUmV0dXJucyBUcnVlIGlmZiBCT0FSRCBpcwogICAgLS0tLS0tLS0tLS0tLQogICAgfCAxIHwgMiB8IDMgfAogICAgLS0tLS0tLS0tLS0tLQogICAgfCA0IHwgNSB8IDYgfAogICAgLS0tLS0tLS0tLS0tLQogICAgfCA3IHwgOCB8ICAgfAogICAgLS0tLS0tLS0tLS0tLScnJwogICAgcmV0dXJuIGJvYXJkID09IFtbMSwyLDNdLFs0LDUsNl0sWzcsOCwwXV0KCmRlZiBzb2x2ZShib2FyZCk6CiAgICAnJydSZXR1cm5zIGEgbGlzdCBvZiBhY3Rpb25zIHdoaWNoLCB0YWtlbiBvbiBCT0FSRCwgc29sdmVzIHRoZSBwdXp6bGUgYnkKICAgIHR1cm5pbmcgdGhlIGJvYXJkIGludG8gdGhlIGZvbGxvd2luZyBmb3JtOgogICAgLS0tLS0tLS0tLS0tLQogICAgfCAxIHwgMiB8IDMgfAogICAgLS0tLS0tLS0tLS0tLQogICAgfCA0IHwgNSB8IDYgfAogICAgLS0tLS0tLS0tLS0tLQogICAgfCA3IHwgOCB8ICAgfAogICAgLS0tLS0tLS0tLS0tLQogICAgUmV0dXJucyAiTk9fU09MVVRJT04iIGlmIHRoZXJlIGlzIG5vIHNvbHV0aW9uLgogICAgJycnCiAgICB2aXNpdGVkID0gc2V0KCkgIyBUaGlzIHN0b3JlcyBib2FyZHMgY29udmVydGVkIHRvIHN0cmluZ3MgZnJvbSAyRCBsaXN0cy4KICAgIHEgPSBbXQogICAgcS5hcHBlbmQoW1tib2FyZCwgTm9uZV1dKSAjIFRoZSBlbGVtZW50cyBvbiB0aGUgZnJpbmdlIGFyZSAoYm9hcmRfc3RhdGUsIGxhc3RfYWN0aW9uKQogICAgd2hpbGUgcToKICAgICAgICBwYXRoID0gcS5wb3AoMCkKICAgICAgICBsYXN0X2JvYXJkID0gcGF0aFstMV1bMF0KICAgICAgICBpZiBzdHIobGFzdF9ib2FyZCkgbm90IGluIHZpc2l0ZWQ6CiAgICAgICAgICAgIHZpc2l0ZWQuYWRkKHN0cihsYXN0X2JvYXJkKSkKICAgICAgICAgICAgaWYgaXNfZ29hbChsYXN0X2JvYXJkKToKICAgICAgICAgICAgICAgICMgcmV0dXJuIHBhdGgKICAgICAgICAgICAgICAgIHJldHVybiBbc3RhdGVbMV0gZm9yIHN0YXRlIGluIHBhdGhdWzE6XSAjIFdlIG9ubHkgbmVlZCB0byByZXR1cm4gYSBsaXN0IG9mIGFjdGlvbnMKICAgICAgICAgICAgZm9yIGFjdGlvbiBpbiBnZXRfbGVnYWxfYWN0aW9ucyhsYXN0X2JvYXJkKToKICAgICAgICAgICAgICAgIG5ld19zdGF0ZSA9IFt0YWtlKGFjdGlvbiwgbGFzdF9ib2FyZCksIGFjdGlvbl0KICAgICAgICAgICAgICAgIG5ld19wYXRoID0gcGF0aCArIFtuZXdfc3RhdGVdCiAgICAgICAgICAgICAgICBxLmFwcGVuZChuZXdfcGF0aCkKICAgIHJldHVybiAiTk9fU09MVVRJT04iCiAgICAKZGVmIGNscygpOgogICAgJycnQ2xlYXJzIHRoZSB0ZXJtaW5hbCBzY3JlZW4uJycnCiAgICBvcy5zeXN0ZW0oJ2NscycgaWYgb3MubmFtZT09J250JyBlbHNlICdjbGVhcicpCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgcHJpbnQoIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iKQogICAgcHJpbnQoIldlbGNvbWUgdG8gUmVhZHlQeXRob24gUHJvamVjdDogU2lsZGluZyBQdXp6bGUhIikKICAgIHBsYXkoKQo='''
eval(compile(base64.b64decode(myscript),'<string>','exec'))