import base64
myscript ='''IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMjIFByb2plY3Q6IFNsaWRpbmcgUHV6emxlICAgICAjIwojIyBDb3B5cmlnaHQgUmVhZHlQeXRob24gU3AxOSAgIyMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpmcm9tIGNvcHkgaW1wb3J0IGRlZXBjb3B5CmZyb20gcmFuZG9tIGltcG9ydCBjaG9pY2UKZnJvbSB0aW1lIGltcG9ydCBzbGVlcAppbXBvcnQgb3MKCnNhbXBsZV9ib2FyZCA9IFsgI3JlcHJlc2VudGVkIGFzIGEgMkQgbGlzdAogICAgWzEsMiwzXSwKICAgIFs0LDUsNl0sCiAgICBbNyw4LDBdICMgMCBzdGFuZHMgZm9yIHRoZSBlbXB0eSBzbG90Cl0KQUNUSU9OUyA9IFsidXAiLCAiZG93biIsICJsZWZ0IiwgInJpZ2h0Il0gI0FjdGlvbnMgYXJlIHJlcHJlc2VudGVkIGFzIHdheXMgdG8gbW92ZSB0aGUgZW1wdHkgc2xvdCAoMCkgYXJvdW5kLgoKZGVmIGNscygpOgogICAgJycnQ2xlYXJzIHRoZSB0ZXJtaW5hbCBzY3JlZW4uJycnCiAgICBvcy5zeXN0ZW0oJ2NscycgaWYgb3MubmFtZT09J250JyBlbHNlICdjbGVhcicpCgpkZWYgcGxheSgpOgogICAgYm9hcmQgPSBzaHVmZmxlKHNhbXBsZV9ib2FyZCkKICAgIHByaW50KCJUaGlzIGlzIHRoZSByYW5kb21seSBzaHVmZmxlZCBpbml0aWFsIHN0YXRlOiIpCiAgICBwcmludF9ib2FyZChib2FyZCkKICAgIHByaW50KCJTb2x2aW5nLi4uIikKICAgIGFjdGlvbnMgPSBzb2x2ZShib2FyZCkKICAgIGlmIGFjdGlvbnMgPT0gIk5PX1NPTFVUSU9OIjoKICAgICAgICBwcmludCgiVGhlcmUgaXMgbm8gc29sdXRpb24gZnJvbSBjdXJyZW50IHN0YXRlLiIpCiAgICAgICAgcmV0dXJuCiAgICBwcmludCgiU29sdmVkISIpCiAgICBpbnB1dCgiUHJlc3MgRW50ZXIgdG8gc3RhcnQgdmlzdWFsaXphdGlvbjogIikKICAgIHZpc3VhbGl6ZShib2FyZCwgYWN0aW9ucykKCmRlZiB2aXN1YWxpemUoYm9hcmQsIGFjdGlvbnMpOgogICAgY29weSA9IGRlZXBjb3B5KGJvYXJkKQogICAgZm9yIGFjdGlvbiBpbiBhY3Rpb25zOgogICAgICAgIGNvcHkgPSB0YWtlKGFjdGlvbiwgY29weSkKICAgICAgICBjbHMoKQogICAgICAgIHByaW50X2JvYXJkKGNvcHkpCiAgICAgICAgc2xlZXAoMSkKICAgIHByaW50KCJTb2x2ZWQhIFRvdGFsIHN0ZXBzOiIsIGxlbihhY3Rpb25zKSkKICAgIHByaW50KCJJbml0aWFsIHN0YXRlOiIpCiAgICBwcmludF9ib2FyZChib2FyZCkKICAgIHByaW50KCJBY3Rpb25zIHRvb2s6IiwgYWN0aW9ucywgIihBY3Rpb25zIGFyZSBkZWZpbmVkIGFzIHdheXMgdGhlIGVtcHR5IHNsb3QgaXMgbW92ZWQgYXJvdW5kLikiKQoKCgpkZWYgcHJpbnRfYm9hcmQoYm9hcmQpOgogICAgJycnUHJpbnRzIEJPQVJEIHRvIGNvbnNvbGUgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6CiAgICAtLS0tLS0tLS0tLS0tCiAgICB8IDQgfCAzIHwgNiB8CiAgICAtLS0tLS0tLS0tLS0tCiAgICB8ICAgfCA1IHwgNyB8CiAgICAtLS0tLS0tLS0tLS0tCiAgICB8IDEgfCA4IHwgNCB8CiAgICAtLS0tLS0tLS0tLS0tCiAgICAnJycKICAgIHByaW50KCItLS0tLS0tLS0tLS0tIikKICAgIGZvciByb3cgaW4gcmFuZ2UobGVuKGJvYXJkKSk6CiAgICAgICAgcHJpbnQoInwgIiwgZW5kPSIiKQogICAgICAgIGZvciBjb2wgaW4gcmFuZ2UobGVuKGJvYXJkWzBdKSk6CiAgICAgICAgICAgIGNvbnRlbnQgPSBib2FyZFtyb3ddW2NvbF0KICAgICAgICAgICAgcHJpbnQoY29udGVudCBpZiBjb250ZW50ICE9IDAgZWxzZSAiICIsIGVuZD0iIHwgIikKICAgICAgICBwcmludCgiXG4tLS0tLS0tLS0tLS0tIikKCmRlZiBmaW5kX3plcm8oYm9hcmQpOgogICAgJycnUmV0dXJucyB0aGUgY29vcmRpbmF0ZSBhcyAocm93X251bWJlciwgY29sdW1uX251bWJlcikKICAgIG9mICIwIiAodGhlIGVtcHR5IHNsb3QpIGluIEJPQVJELgoKICAgIEUuZy4KICAgIFRoZSB6ZXJvIGNvb3JkaW5hdGUgb2YgdGhlIGZvbGxvd2luZyBib2FyZCBpcyAoMSwgMCkKICAgIC0tLS0tLS0tLS0tLS0KICAgIHwgMiB8IDMgfCA2IHwKICAgIC0tLS0tLS0tLS0tLS0KICAgIHwgICB8IDUgfCA3IHwKICAgIC0tLS0tLS0tLS0tLS0KICAgIHwgMSB8IDggfCA0IHwKICAgIC0tLS0tLS0tLS0tLS0KICAgICcnJwogICAgZm9yIHJvdyBpbiByYW5nZShsZW4oYm9hcmQpKToKICAgICAgICBmb3IgY29sIGluIHJhbmdlKGxlbihib2FyZFswXSkpOgogICAgICAgICAgICBpZiBib2FyZFtyb3ddW2NvbF0gPT0gMDoKICAgICAgICAgICAgICAgIHJldHVybiByb3csIGNvbAoKZGVmIGdldF9sZWdhbF9hY3Rpb25zKGJvYXJkKToKICAgICcnJ1JldHVybnMgYSBsaXN0IG9mIGxlZ2FsIGFjdGlvbnMgaW4gQk9BUkQuIEFjdGlvbnMgYXJlIHJlcHJlc2VudGVkCiAgICBhcyB3YXlzIHRvIG1vdmUgdGhlIGVtcHR5IHNsb3QgKDApIGFyb3VuZC4gQW4gYWN0aW9uIHNob3VsZCBiZSBpbgogICAgWyJ1cCIsICJkb3duIiwgImxlZnQiLCAicmlnaHQiXS4KCiAgICBFLmcuIEluIHRoZSBmb2xsb3dpbmcgYm9hcmQsIHRoZSBsZWdhbCBhY3Rpb25zIGFyZSBbInVwIiwgImRvd24iLCAicmlnaHQiXS4KICAgIC0tLS0tLS0tLS0tLS0KICAgIHwgMiB8IDMgfCA2IHwKICAgIC0tLS0tLS0tLS0tLS0KICAgIHwgICB8IDUgfCA3IHwKICAgIC0tLS0tLS0tLS0tLS0KICAgIHwgMSB8IDggfCA0IHwKICAgIC0tLS0tLS0tLS0tLS0nJycKICAgIHplcm9fcG9zID0gZmluZF96ZXJvKGJvYXJkKQogICAgYm9hcmRfcm93cyA9IGxlbihib2FyZCkKICAgIGJvYXJkX2NvbHMgPSBsZW4oYm9hcmRbMF0pCiAgICBhY3Rpb25zID0gQUNUSU9OU1s6XQogICAgaWYgemVyb19wb3NbMF0gPT0gMDoKICAgICAgICBhY3Rpb25zLnJlbW92ZSgidXAiKQogICAgaWYgemVyb19wb3NbMF0gPT0gYm9hcmRfcm93cyAtIDE6CiAgICAgICAgYWN0aW9ucy5yZW1vdmUoImRvd24iKQogICAgaWYgemVyb19wb3NbMV0gPT0gMDoKICAgICAgICBhY3Rpb25zLnJlbW92ZSgibGVmdCIpCiAgICBpZiB6ZXJvX3Bvc1sxXSA9PSBib2FyZF9jb2xzIC0gMToKICAgICAgICBhY3Rpb25zLnJlbW92ZSgicmlnaHQiKQogICAgcmV0dXJuIGFjdGlvbnMKCmRlZiB0YWtlKGFjdGlvbiwgYm9hcmQpOgogICAgJycnUmV0dXJucyB0aGUgcmVzdWx0aW5nIGJvYXJkIGFmdGVyIHRha2luZyBBQ1RJT04gb24gQk9BUkQsCiAgICBhc3N1bWluZyBBQ1RJT04gaXMgbGVnYWwuIEFDVElPTiBzaG91bGQgYmUgaW4gWyJ1cCIsICJkb3duIiwgImxlZnQiLCAicmlnaHQiXS4KICAgIEFjdGlvbnMgYXJlIHJlcHJlc2VudGVkIGFzIHdheXMgdG8gbW92ZSB0aGUgZW1wdHkgc2xvdCAoMCkgYXJvdW5kLgoKICAgIEUuZy4KICAgIC0tLS0tLS0tLS0tLS0KICAgIHwgMiB8IDMgfCA2IHwKICAgIC0tLS0tLS0tLS0tLS0KICAgIHwgICB8IDUgfCA3IHwKICAgIC0tLS0tLS0tLS0tLS0KICAgIHwgMSB8IDggfCA0IHwKICAgIC0tLS0tLS0tLS0tLS0KICAgIFRha2luZyBhY3Rpb24gInVwIiBpbiB0aGUgYWJvdmUgYm9hcmQgd2lsbCByZXN1bHQgaW4gdGhlIGZvbGxvd2luZyBib2FyZDoKICAgIC0tLS0tLS0tLS0tLS0KICAgIHwgICB8IDMgfCA2IHwKICAgIC0tLS0tLS0tLS0tLS0KICAgIHwgMiB8IDUgfCA3IHwKICAgIC0tLS0tLS0tLS0tLS0KICAgIHwgMSB8IDggfCA0IHwKICAgIC0tLS0tLS0tLS0tLS0KICAgICcnJwogICAgYXNzZXJ0IGFjdGlvbiBpbiBBQ1RJT05TLCAiSW52YWxpZCBhY3Rpb246ICd7fSciLmZvcm1hdChhY3Rpb24pCiAgICB6ZXJvX3BvcyA9IGZpbmRfemVybyhib2FyZCkKICAgIHplcm9fcm93ID0gemVyb19wb3NbMF0KICAgIHplcm9fY29sID0gemVyb19wb3NbMV0KICAgIG5ld19ib2FyZCA9IGRlZXBjb3B5KGJvYXJkKQogICAgaWYgYWN0aW9uID09ICJ1cCI6CiAgICAgICAgbmV3X2JvYXJkW3plcm9fcm93XVt6ZXJvX2NvbF0sIG5ld19ib2FyZFt6ZXJvX3JvdyAtIDFdW3plcm9fY29sXSA9IG5ld19ib2FyZFt6ZXJvX3JvdyAtIDFdW3plcm9fY29sXSwgbmV3X2JvYXJkW3plcm9fcm93XVt6ZXJvX2NvbF0KICAgIGlmIGFjdGlvbiA9PSAiZG93biI6CiAgICAgICAgbmV3X2JvYXJkW3plcm9fcm93XVt6ZXJvX2NvbF0sIG5ld19ib2FyZFt6ZXJvX3JvdyArIDFdW3plcm9fY29sXSA9IG5ld19ib2FyZFt6ZXJvX3JvdyArIDFdW3plcm9fY29sXSwgbmV3X2JvYXJkW3plcm9fcm93XVt6ZXJvX2NvbF0KICAgIGlmIGFjdGlvbiA9PSAibGVmdCI6CiAgICAgICAgbmV3X2JvYXJkW3plcm9fcm93XVt6ZXJvX2NvbF0sIG5ld19ib2FyZFt6ZXJvX3Jvd11bemVyb19jb2wgLSAxXSA9IG5ld19ib2FyZFt6ZXJvX3Jvd11bemVyb19jb2wgLSAxXSwgbmV3X2JvYXJkW3plcm9fcm93XVt6ZXJvX2NvbF0KICAgIGlmIGFjdGlvbiA9PSAicmlnaHQiOgogICAgICAgIG5ld19ib2FyZFt6ZXJvX3Jvd11bemVyb19jb2xdLCBuZXdfYm9hcmRbemVyb19yb3ddW3plcm9fY29sICsgMV0gPSBuZXdfYm9hcmRbemVyb19yb3ddW3plcm9fY29sICsgMV0sIG5ld19ib2FyZFt6ZXJvX3Jvd11bemVyb19jb2xdCiAgICByZXR1cm4gbmV3X2JvYXJkCgpkZWYgc2h1ZmZsZShib2FyZCk6CiAgICAnJydSZXR1cm4gYSBuZXcgYm9hcmQgb2J0YWluZWQgYnkgdGFraW5nIDUwIHJhbmRvbQogICAgYWN0aW9ucyBmcm9tIEJPQVJELiAnJycKICAgIG5ld19ib2FyZCA9IGRlZXBjb3B5KGJvYXJkKQogICAgZm9yIGkgaW4gcmFuZ2UoNTApOgogICAgICAgIGFjdGlvbiA9IGNob2ljZShnZXRfbGVnYWxfYWN0aW9ucyhuZXdfYm9hcmQpKQogICAgICAgIG5ld19ib2FyZCA9IHRha2UoYWN0aW9uLCBuZXdfYm9hcmQpCiAgICByZXR1cm4gbmV3X2JvYXJkCgpkZWYgaXNfZ29hbChib2FyZCk6CiAgICAnJydSZXR1cm5zIFRydWUgaWZmIEJPQVJEIGlzCiAgICAtLS0tLS0tLS0tLS0tCiAgICB8IDEgfCAyIHwgMyB8CiAgICAtLS0tLS0tLS0tLS0tCiAgICB8IDQgfCA1IHwgNiB8CiAgICAtLS0tLS0tLS0tLS0tCiAgICB8IDcgfCA4IHwgICB8CiAgICAtLS0tLS0tLS0tLS0tJycnCiAgICByZXR1cm4gYm9hcmQgPT0gW1sxLDIsM10sWzQsNSw2XSxbNyw4LDBdXQoKZGVmIHNvbHZlKGJvYXJkKToKICAgICcnJ1JldHVybnMgYSBsaXN0IG9mIGFjdGlvbnMgd2hpY2gsIHRha2VuIG9uIEJPQVJELCBzb2x2ZXMgdGhlIHB1enpsZSBieQogICAgdHVybmluZyB0aGUgYm9hcmQgaW50byB0aGUgZm9sbG93aW5nIGZvcm06CiAgICAtLS0tLS0tLS0tLS0tCiAgICB8IDEgfCAyIHwgMyB8CiAgICAtLS0tLS0tLS0tLS0tCiAgICB8IDQgfCA1IHwgNiB8CiAgICAtLS0tLS0tLS0tLS0tCiAgICB8IDcgfCA4IHwgICB8CiAgICAtLS0tLS0tLS0tLS0tCiAgICAnJycKICAgIHZpc2l0ZWQgPSBzZXQoKSAjIFRoaXMgc3RvcmVzIGJvYXJkcyBjb252ZXJ0ZWQgdG8gc3RyaW5ncyBmcm9tIDJEIGxpc3RzLgogICAgcSA9IFtdCiAgICBxLmFwcGVuZChbW2JvYXJkLCBOb25lXV0pICMgVGhlIGVsZW1lbnRzIG9uIHRoZSBmcmluZ2UgYXJlIChib2FyZF9zdGF0ZSwgbGFzdF9hY3Rpb24pCiAgICB3aGlsZSBxOgogICAgICAgIHBhdGggPSBxLnBvcCgwKQogICAgICAgIGxhc3RfYm9hcmQgPSBwYXRoWy0xXVswXQogICAgICAgIGlmIHN0cihsYXN0X2JvYXJkKSBub3QgaW4gdmlzaXRlZDoKICAgICAgICAgICAgdmlzaXRlZC5hZGQoc3RyKGxhc3RfYm9hcmQpKQogICAgICAgICAgICBpZiBpc19nb2FsKGxhc3RfYm9hcmQpOgogICAgICAgICAgICAgICAgIyByZXR1cm4gcGF0aAogICAgICAgICAgICAgICAgIyByZXR1cm4gWyJyaWdodCIsICJ1cCIsICJsZWZ0IiwgImRvd24iXQogICAgICAgICAgICAgICAgcmV0dXJuIFtzdGF0ZVsxXSBmb3Igc3RhdGUgaW4gcGF0aF1bMTpdICMgV2Ugb25seSBuZWVkIHRvIHJldHVybiBhIGxpc3Qgb2YgYWN0aW9ucwogICAgICAgICAgICBmb3IgYWN0aW9uIGluIGdldF9sZWdhbF9hY3Rpb25zKGxhc3RfYm9hcmQpOgogICAgICAgICAgICAgICAgbmV3X3N0YXRlID0gW3Rha2UoYWN0aW9uLCBsYXN0X2JvYXJkKSwgYWN0aW9uXQogICAgICAgICAgICAgICAgbmV3X3BhdGggPSBwYXRoICsgW25ld19zdGF0ZV0KICAgICAgICAgICAgICAgIHEuYXBwZW5kKG5ld19wYXRoKQogICAgcmV0dXJuICJOT19TT0xVVElPTiIKCnByaW50KCI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IikKcHJpbnQoIldlbGNvbWUgdG8gUmVhZHlQeXRob24gUHJvamVjdDogU2lsZGluZyBQdXp6bGUhIikKcGxheSgpCg=='''
eval(compile(base64.b64decode(myscript),'<string>','exec'))